This is commit 17 in branch master.after iss4 rebase from master.
